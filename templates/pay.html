{% extends 'base.html' %}
{% load static %}
{% block content %}

<!--Main Navigation-->
<section>
    <style>
      #intro {
      background-image: url(https://mdbootstrap.com/img/new/fluid/city/008.jpg);
      height: 100vh;
      }
  
      /* Height for devices larger than 576px */
      @media (min-width: 992px) {
      #intro {
          margin-top: -58.59px;
      }
      }
    </style>
  
    <!-- Background image -->
    <div id="intro" class="bg-image shadow-2-strong">
        <div class="mask d-flex align-items-center h-100" style="background-color: rgba(0, 0, 0, 0.8);">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-xl-5 col-md-8">
                        
                        <div class="col-md-8 mb-4">

                            <div class="card">
                                <div class="card-body">
                                            
                                    <div class="card-header bg-white text-center py-3">
                                        <h5 class="mb-0 fw-bold">Summary</h5>
                                    </div>
                        
                                    <div class="card-body">
                                        <ul>
                                            <li><strong>Delivery fee: </strong>$100</li>
                                            <li><strong>Service fee: </strong>$50</li>
                                            <li><strong>Total items: </strong>{{order.get_cart_items}}</li>
                                        </ul>
                                    </div>
                        
                                    <div
                                        class="card-footer bg-white d-flex justify-content-between py-3"
                                    >
                                        <strong>Total amount:</strong>
                                        <strong>{{order.get_cart_total|floatformat:2}}</strong>
                                    </div>

                                </div>
                                <!-- Set up a container element for the button -->
                                <div id="paypal-button-container"></div>
                            </div>
                        </div>
                        

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Background image -->
    
    <script src="https://www.paypal.com/sdk/js?client-id=AW_UGngJPdhmo5GQIG9Cxek96ITIzoPUmPano_DXfhmupMEH8mB4l86W2pavw3mGEKNmzYModIiHRU8j&currency=USD"></script>

    <script>
        paypal.Buttons({
        // Order is created on the server and the order id is returned
        createOrder: (data, actions) => {
            return fetch(order.get_cart_total, {
            method: "post",
            // use the "body" param to optionally pass additional order information
            // like product ids or amount
            })
            .then((response) => response.json())
            .then((order) => order.id);
        },
        // Finalize the transaction on the server after payer approval
        onApprove: (data, actions) => {
            return fetch(`/api/orders/${data.orderID}/capture`, {
            method: "post",
            })
            .then((response) => response.json())
            .then((orderData) => {
            // Successful capture! For dev/demo purposes:
            console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
            const transaction = orderData.purchase_units[0].payments.captures[0];
            alert(`Transaction ${transaction.status}: ${transaction.id}\n\nSee console for all available details`);
            // When ready to go live, remove the alert and show a success message within this page. For example:
            // const element = document.getElementById('paypal-button-container');
            // element.innerHTML = '<h3>Thank you for your payment!</h3>';
            // Or go to another URL:  actions.redirect('thank_you.html');
            });
        }
        }).render('#paypal-button-container');
    </script> 


</section>
<!--Main Navigation-->

{% endblock content %}